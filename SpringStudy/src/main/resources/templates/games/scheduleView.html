<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>KBO 경기 일정</title>
    <link rel="stylesheet" href="/games/schedule.css"/>
    <link rel="icon" type="image/png" href="/dugout.png"/>
    <!-- Swiper -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet"/>
</head>
<body>

<!-- 상단 소개 -->
<section class="hero">
    <h1>KBO 경기 일정</h1>
    <p>날짜를 선택해 오늘의 경기 일정을 확인하세요</p>
</section>

<div class="container">
    <!-- 날짜 선택 슬라이더 -->
    <div class="swiper date-swiper">
        <div class="swiper-wrapper">
            <div class="swiper-slide"
                 th:each="d : ${availableDates}"
                 th:text="${d}"
                 th:classappend="${d == selectedDate} ? 'active' : ''"
                 th:attr="data-date=${d}">
            </div>
        </div>
    </div>

    <!-- 선택한 날짜 표시 -->
    <h2 style="text-align:center; margin-top: 20px;" th:text="'📅 ' + ${selectedDate} + ' 경기 일정'">
        📅 08.03 경기 일정
    </h2>

    <!-- 경기 목록 -->
    <div class="schedule-wrapper">
        <!-- ✅ 반복되는 경기 -->
        <div class="game-row" th:each="game : ${games}">
            <div class="time" th:text="${game.time}">18:00</div>



            <div class="matchup">
        <span class="team">
            <img th:src="'https://myspringstudybucket.s3.ap-northeast-2.amazonaws.com/test/teamLogo/teamLogo/' + ${teamLogoMap[game.homeTeam]} + '.png'"
                 th:alt="${game.homeTeam}"
                 class="team-logo"/>
            <span th:text="${game.homeTeam}">삼성</span>
        </span>

                <span class="vs">vs</span>

                <span class="team">
            <span th:text="${game.awayTeam}">두산</span>
            <img th:src="'https://myspringstudybucket.s3.ap-northeast-2.amazonaws.com/test/teamLogo/teamLogo/' + ${teamLogoMap[game.awayTeam]} + '.png'"
                 th:alt="${game.awayTeam}"
                 class="team-logo"/>
        </span>
                <div class="stadium-info" th:text=" ${game.stadium}"
                     style="font-size: 0.9rem; color: #94a3b8; margin-top: 4px;">
                    고척 스카이돔
                </div>
            </div>
        </div>
        <!-- 경기 없을 때 메시지: 반복 밖으로 빼야 함 -->
        <p th:if="${games.size() == 0}" style="text-align:center; margin-top: 40px; color: #94a3b8;">
            😢 선택한 날짜에 경기가 없습니다.
        </p>
    </div>


    <div class="back-btn">
        <a href="/dugout" class="btn">더그아웃 홈으로</a>
    </div>


    <footer>
        © 2025 DUGOUT | KBO 경기 일정 제공
    </footer>


    <!-- 날짜 및 스크립트 (선택 날짜 유지) -->
    <script th:inline="javascript">
        const selectedDate = /*[[${selectedDate}]]*/ "08.01";
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const slides = document.querySelectorAll('.swiper-slide');
            const index = Array.from(slides).findIndex(el => el.textContent.trim() === selectedDate);

            const swiper = new Swiper('.date-swiper', {
                slidesPerView: 5,
                spaceBetween: 12,
                centeredSlides: true,
                mousewheel: {
                    forceToAxis: true,
                    sensitivity: 1,
                    releaseOnEdges: true
                },
                breakpoints: {
                    768: {slidesPerView: 6},
                    1024: {slidesPerView: 7}
                },
                on: {
                    init: function () {
                        if (index !== -1) {
                            this.slideTo(index, 0); // 즉시 이동
                        }
                    }
                }
            });

            swiper.init(); // 수동 초기화로 정확한 위치 지정

            slides.forEach(el => {
                el.addEventListener('click', () => {
                    const date = el.getAttribute('data-date');
                    window.location.href = `/schedule?date=${encodeURIComponent(date)}`;
                });
            });
        });
    </script>
</div>
</body>
</html>
